<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>setisikiW</title>
<style>
maincontent{
    transform: scaleX(-1);
}
body {
    font-family: sans-serif;
    direction: rtl;
    margin: 0;
    padding: 20px;
    background: #fff;
    color: #000;
    transition: background 0.3s, color 0.3s;
}

#searchBar {
    width: 100%;
    font-size: 18px;
    padding: 10px;
    margin-bottom: 20px;
    transform: scaleX(-1);
    border: 2px solid #ff6363;
    border-radius: 6px;
    outline: none;
    transition: border-color 0.3s, background 0.3s, color 0.3s;
}

#searchBar:focus {
    border-color: #d64f4f;
}

#content {
    max-width: 1000px;
    margin: auto;
}

img, table, pre {
    transform: scaleX(-1);
    max-width: 100%;
    height: auto;
}

table {
    transform: scaleX(-1);
    border-collapse: collapse;
    width: 100%;
}
table, th, td {
    transform: scaleX(-1);
    border: 1px solid #aaa;
}
th, td {
    transform: scaleX(-1);
    padding: 4px 8px;
}

a {
    transform: scaleX(-1);
    color: #ff6363;
    cursor: pointer;
    text-decoration: none;
    transition: color 0.3s;
}
a:hover {
    color: #d64f4f;
}

h1,h2,h3,h4,h5,h6 {
    transform: scaleX(-1);
    border-bottom: 1px solid #ccc;
    padding-bottom: 4px;
    margin-top: 20px;
    color: #ff6363;
    transition: color 0.3s;
}

/* ドーモクーダ */
@media (prefers-color-scheme: dark) {
    body {
        background: #1e1e1e;
        color: #e0e0e0;
    }
    #searchBar {
        background: #333;
        color: #e0e0e0;
        border-color: #ff8585;
    }
    #searchBar:focus {
        border-color: #ffa1a1;
    }
    table, th, td {
        border-color: #555;
    }
    a {
        color: #ff8585;
    }
    a:hover {
        color: #ffa1a1;
    }
    h1,h2,h3,h4,h5,h6 {
        color: #ff8585;
        border-color: #555;
    }
}
    #sitelogo {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 100px;
    height: auto;
    z-index: 1000;
  }
</style>
</head>
<body>
<input id="searchBar" type="text" placeholder="Wikipedia検索" onkeydown="if(event.key==='Enter'){searchWiki()}">
<div id="content">ここに記事が表示されます</div>

<script>
async function searchWiki() {
    const query = document.getElementById('searchBar').value;
    if(!query) return;
    const searchUrl = `https://ja.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&format=json&origin=*`;
    try {
        const searchRes = await fetch(searchUrl);
        const searchData = await searchRes.json();
        if(!searchData.query.search.length){
            document.getElementById('content').innerHTML = '見つかりませんでした';
            return;
        }
        const title = searchData.query.search[0].title;
        loadPage(title);
    } catch(err){
        document.getElementById('content').innerHTML = '検索中にエラーが発生しました';
    }
}

async function loadPage(title){
    const pageUrl = `https://ja.wikipedia.org/w/api.php?action=parse&page=${encodeURIComponent(title)}&format=json&origin=*`;
    try {
        const pageRes = await fetch(pageUrl);
        const pageData = await pageRes.json();
        const html = pageData.parse.text['*'];
        document.getElementById('content').innerHTML = html;

        document.querySelectorAll('#content a').forEach(a => {
            a.onclick = e => {
                e.preventDefault();
                const href = a.getAttribute('href');
                if(!href.startsWith('/wiki/')) return;
                const newTitle = decodeURIComponent(href.replace('/wiki/', ''));
                document.getElementById('searchBar').value = newTitle;
                loadPage(newTitle);
            }
        });

        document.querySelectorAll('#content img, #content table, #content pre').forEach(el => {
            el.style.transform = 'scaleX(-1)';
        });
    } catch(err){
        document.getElementById('content').innerHTML = 'ページ読み込み中にエラーが発生しました';
    }
}
</script>
<a href="https://harmony9725.github.io/HARMONY9725s_made/"><img id="sitelogo" src="images/sitelogo.png" alt="sitelogo"></a>
</body>
</html>
